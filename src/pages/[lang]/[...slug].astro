---
import { CollectionEntry, getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import { normalizeSlug, removeLangFromSlug } from "../../lib/i18n/slugModify";

export async function getStaticPaths() {
	const allPages = await getCollection("docs")
	return allPages.map((page) => {
		let slug = normalizeSlug(page.slug);
		let [lang] = slug.split("/")
		return {
			params: { slug: removeLangFromSlug(slug), lang },
			props: page
		}
	})
}

export type Props = CollectionEntry<'docs'>;
const { data, render } = Astro.props;
const { Content, headings } = await render();

---

<Layout {...{ headings, content: data, lang: Astro.params.lang as string }}>
	<Content />
</Layout>